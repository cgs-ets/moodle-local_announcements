define(["jquery","local_announcements/audienceselector","local_announcements/impersonateselector","core/log","core/modal_factory","core/modal_events","core/templates","core/form-autocomplete"],function(i,n,o,e,t,a,l,s){"use strict";function c(n){this.rootel=n}return c.prototype.main=function(){var e=this,t=!1;n.init(),o.init(),e.rootel.on("submit","form[data-form=lann-post]",function(n){if(!t){n.preventDefault(),e.handleSubmit(this)}}),e.rootel.on("click",'form[data-form=lann-post] input[name="cancel"]',function(n){t=!0})},c.prototype.handleSubmit=function(n){var o=this.rootel.find(".audience-selector").first(),a=!1;i(".roles>ul").removeClass("warn"),this.rootel.find(".contents").each(function(){var n=i(this).find(".item:checked"),e=i(this).find(".role:checked");i(this).data("audiencehasroles")&&0<n.length&&0==e.length&&(a=!0,o.find(".roles>ul").addClass("warn"));var t=o.find(".intersection-workspace.has-tags");t.length&&(a=!0,t.addClass("warn"))}),a||(i(".lann-post-overlay").addClass("active"),n.submit())},{init:function(){e.debug("local_announcements/post: initializing");var n=i("#page-local-announcements-post");n.length?new c(n).main():e.error("local_announcements/post: #page-local-announcements-post not found!")}}});